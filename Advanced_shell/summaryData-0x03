#!/bin/bash

# Create CSV header
echo "Name,Height(m),Weight(kg)" > pokemon_report.csv

# Process each JSON file in the pokemon_data directory
for file in pokemon_data/*.json; do
    if [ -f "$file" ]; then
        # Extract data using jq
        name=$(jq -r '.name' "$file")
        height=$(jq -r '.height' "$file")
        weight=$(jq -r '.weight' "$file")
        
        # Convert units (height: decimeters to meters, weight: hectograms to kg)
        height_m=$(echo "scale=2; $height / 10" | bc)
        weight_kg=$(echo "scale=2; $weight / 10" | bc)
        
        # Add to CSV
        echo "$name,$height_m,$weight_kg" >> pokemon_report.csv
    fi
done

# Display the CSV file
echo "Pokémon Report:"
echo "================"
cat pokemon_report.csv
echo ""

# Calculate averages using awk
echo "Summary Statistics:"
echo "==================="
awk -F, '
NR > 1 {
    total_height += $2
    total_weight += $3
    count++
}
END {
    if (count > 0) {
        avg_height = total_height / count
        avg_weight = total_weight / count
        printf "Average Height: %.2fm\n", avg_height
        printf "Average Weight: %.2fkg\n", avg_weight
        printf "Total Pokémon: %d\n", count
    } else {
        print "No Pokémon data found"
    }
}
' pokemon_report.csv
